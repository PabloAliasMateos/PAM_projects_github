Version 4
SHEET 1 3644 2592
WIRE 944 -48 944 -80
WIRE 656 16 592 16
WIRE 496 32 416 32
WIRE -384 48 -560 48
WIRE 128 48 -384 48
WIRE 944 48 944 32
WIRE 944 48 592 48
WIRE -560 96 -560 48
WIRE 944 96 944 48
WIRE 544 128 544 96
WIRE 576 128 544 128
WIRE -192 160 -240 160
WIRE 128 160 128 48
WIRE 128 160 32 160
WIRE -240 176 -240 160
WIRE -192 224 -288 224
WIRE 128 224 32 224
WIRE 848 224 592 224
WIRE 944 224 944 176
WIRE 944 224 848 224
WIRE 1184 224 944 224
WIRE -560 240 -560 176
WIRE 496 240 416 240
WIRE 1456 240 1280 240
WIRE 1616 240 1456 240
WIRE 1776 240 1616 240
WIRE 656 256 592 256
WIRE 944 272 944 224
WIRE -192 288 -512 288
WIRE 128 288 32 288
WIRE 1232 320 1232 288
WIRE 1264 320 1232 320
WIRE 1456 320 1456 240
WIRE 1616 320 1616 240
WIRE 1776 320 1776 240
WIRE 544 336 544 304
WIRE 576 336 544 336
WIRE -384 352 -384 48
WIRE -192 352 -384 352
WIRE 112 352 32 352
WIRE 944 400 944 336
WIRE 784 416 592 416
WIRE 1456 416 1456 384
WIRE 1616 416 1616 384
WIRE 1776 416 1776 384
WIRE 496 432 416 432
WIRE 112 448 112 416
WIRE 848 448 848 224
WIRE 848 448 592 448
WIRE 544 528 544 496
WIRE 576 528 544 528
WIRE 944 576 944 528
WIRE 480 656 480 624
WIRE 784 672 784 416
WIRE 944 672 944 656
WIRE 944 672 784 672
WIRE 96 704 96 688
WIRE 480 704 480 656
WIRE 944 704 944 672
WIRE 96 752 96 704
WIRE 1024 752 1008 752
WIRE 1072 752 1024 752
WIRE 1136 752 1072 752
WIRE 1264 752 1216 752
WIRE 1392 752 1328 752
WIRE 1488 752 1392 752
WIRE 1584 752 1584 656
WIRE 1392 784 1392 752
WIRE 32 800 -16 800
WIRE 1024 800 1024 752
WIRE 1072 800 1072 752
WIRE 480 832 480 784
WIRE -176 880 -336 880
WIRE -16 880 -16 800
WIRE -16 880 -96 880
WIRE 96 880 96 848
WIRE 416 880 96 880
WIRE -512 896 -512 288
WIRE -432 896 -512 896
WIRE 944 896 944 800
WIRE 1024 896 1024 864
WIRE 1072 896 1072 880
WIRE 1392 896 1392 864
WIRE -800 912 -800 864
WIRE 96 912 96 880
WIRE -16 960 -16 880
WIRE 32 960 -16 960
WIRE 480 960 480 928
WIRE -800 1008 -800 992
WIRE -720 1008 -800 1008
WIRE -800 1024 -800 1008
WIRE -576 1040 -608 1040
WIRE -576 1056 -576 1040
WIRE 96 1056 96 1008
WIRE 1152 1056 1152 1040
WIRE -608 1088 -608 1040
WIRE 1152 1088 1152 1056
WIRE -800 1104 -800 1088
WIRE -720 1104 -720 1008
WIRE -640 1104 -720 1104
WIRE -384 1120 -384 960
WIRE -384 1120 -576 1120
WIRE -640 1136 -800 1136
WIRE -608 1200 -608 1152
WIRE -800 1232 -800 1136
WIRE 1152 1232 1152 1184
WIRE 1264 1232 1152 1232
WIRE 1152 1264 1152 1232
WIRE -800 1328 -800 1312
WIRE 1152 1360 1152 1344
WIRE -624 1440 -656 1440
FLAG -240 176 0
FLAG 112 448 0
FLAG 944 400 0
FLAG -560 240 0
FLAG -560 48 Vcc
FLAG 1152 1056 Vcc
FLAG 1264 1232 sel_mode
IOPIN 1264 1232 Out
FLAG 576 128 sel_mode
IOPIN 576 128 In
FLAG 576 336 sel_mode
IOPIN 576 336 In
FLAG 576 528 sel_mode
IOPIN 576 528 In
FLAG 1264 320 sel_mode
IOPIN 1264 320 In
FLAG 128 224 discharge
FLAG 128 288 threshold
FLAG -288 224 trigger
FLAG 416 32 discharge
FLAG 416 240 threshold
FLAG 416 432 trigger
FLAG 944 -80 Vcc
FLAG 656 16 threshold
FLAG 656 256 trigger
FLAG 1456 416 0
FLAG 1584 656 Vcc
FLAG 1392 896 0
FLAG 1072 896 0
FLAG 944 896 0
FLAG 944 528 Vcc
FLAG 1024 896 0
FLAG 1616 416 0
FLAG 1776 416 0
FLAG 480 960 0
FLAG 480 656 Vcc
FLAG 96 1056 0
FLAG 96 704 Vcc
FLAG -800 864 sel_mode
IOPIN -800 864 In
FLAG -800 1104 0
FLAG 1152 1360 0
FLAG -800 1328 0
FLAG -576 1056 0
FLAG -608 1200 Vcc
SYMBOL Misc\\NE555 -80 256 R0
SYMATTR InstName U1
SYMBOL cap 96 352 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL res 928 -64 R0
SYMATTR InstName R1
SYMATTR Value {R1_555}
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res 928 80 R0
SYMATTR InstName R2_potentiometer
SYMATTR Value {R2_555}
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL cap 928 272 R0
SYMATTR InstName C_monostable
SYMATTR Value {C_555}
SYMATTR SpiceLine V=25 Irms=0 Rser=0.007 Lser=0
SYMBOL voltage -560 80 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 132 Left 2
SYMATTR SpiceLine Rser=.8
SYMATTR InstName Vcc
SYMATTR Value 12
SYMBOL Componentes\ Crisa\\Varios\\Multiplexor2e 544 32 M0
SYMATTR InstName U2
SYMBOL Componentes\ Crisa\\Varios\\Multiplexor2e 544 240 M0
SYMATTR InstName U3
SYMBOL Componentes\ Crisa\\Varios\\Multiplexor2e 544 432 M0
SYMATTR InstName U4
SYMBOL Componentes\ Crisa\\Varios\\Multiplexor2e 1232 224 M0
SYMATTR InstName U5
SYMBOL cap 1440 320 R0
SYMATTR InstName C_compens
SYMATTR Value 33n
SYMATTR SpiceLine V=25 Irms=0 Rser=0.007 Lser=0
SYMBOL cap 1264 736 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL res 1120 736 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 1056 896 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res 1376 880 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 10K
SYMBOL Componentes\ Crisa\\Modelos\\Switch_Close 1488 752 M90
WINDOW 0 -5 48 VBottom 2
WINDOW 123 41 380 VTop 2
SYMATTR InstName U6
SYMATTR Value2 Tclose=20*(C_555*ln(2)*(R1_555+2*R2_555))+R_delay*C_delay
SYMBOL res 960 560 M0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL cap 1600 320 R0
SYMATTR InstName C_compens1
SYMATTR Value 220n
SYMATTR SpiceLine V=25 Irms=0 Rser=0.007 Lser=0
SYMBOL cap 1760 320 R0
SYMATTR InstName C_compens2
SYMATTR Value 330n
SYMATTR SpiceLine V=25 Irms=0 Rser=0.007 Lser=0
SYMBOL diode 1040 864 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL res 464 688 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL AutoGenerated\\IPB015N08N5_L1 512 912 R0
WINDOW 3 -28 96 Top 2
WINDOW 39 -67 73 Top 2
WINDOW 0 13 46 Bottom 2
SYMATTR InstName U7
SYMBOL npn 1008 704 M0
SYMATTR InstName Q2
SYMATTR Value PMMT491A
SYMATTR Prefix X
SYMBOL pnp 32 1008 M180
SYMATTR InstName Q1
SYMATTR Value QPBHV9115T
SYMBOL npn 32 752 R0
SYMATTR InstName Q3
SYMATTR Value PMMT491A
SYMATTR Prefix X
SYMBOL res -80 864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 1K
SYMBOL Componentes\ Crisa\\Varios\\Multiplexor2e -384 896 M0
SYMATTR InstName U9
SYMBOL cap -816 1024 R0
SYMATTR InstName C2
SYMATTR Value {C_delay}
SYMBOL res -816 896 R0
SYMATTR InstName R4
SYMATTR Value {R_delay}
SYMBOL Componentes\ Crisa\\Modelos\\Switch_Close 1152 1088 M0
SYMATTR InstName U10
SYMATTR Value2 Tclose= (19*(C_555*ln(2)*(R1_555+2*R2_555))+0.5*C_555*ln(2)*R2_555)
SYMATTR SpiceLine Ron=1n Roff=100000Meg
SYMBOL res 1136 1248 R0
SYMATTR InstName R3
SYMATTR Value 1Meg
SYMBOL voltage -800 1216 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 132 Left 2
SYMATTR SpiceLine Rser=0
SYMATTR InstName Vcc1
SYMATTR Value 5
SYMBOL Comparators\\LT1018 -608 1120 M180
SYMATTR InstName U8
TEXT -560 -104 Left 3 !.tran {stop_time}
TEXT 144 -184 Left 2 ;This MUX network allows to switch between astable and monostable mode
TEXT 1360 80 Left 2 ;In astable mode, ton = ln(2)*C*(R1+R2)\nIn monostable mode, tpulse = ln(3)*C*(R1+R2)\nSince the objective is to use the ton of the astable mode to configure the tpulse which generates\nthe SC, the ln() factors must be compensated by increasing C in monostable mode by a factor of ln()3\n/ln(2)
TEXT 1568 1264 Left 2 ;sel_mode = 0 : astable mode\nsel_mode = 1 : monostable mode
TEXT 912 992 Left 2 ;Edge detector + inversor : to trigger the SC when the circuit is in monostable mode
TEXT 968 80 Left 2 ;R2_555  [1n,100K]
TEXT -560 -176 Left 2 !.include OptiMOS5_80V_PSpice.lib
TEXT -560 -144 Left 2 !.include SC_generator_models.txt
TEXT -1000 1408 Left 2 ;Comparator and voltage source to simulate MUX high threshold value
TEXT -1608 984 Left 2 ;Control delay network to avoid spurious SC command during the \nastable monostable transition (see handwritten analysis)
TEXT -560 -56 Left 2 !.param stop_time = 40*(C_555*ln(2)*(R1_555+2*R2_555))+R_delay*C_delay
TEXT 1064 -128 Left 2 !.param R1_555 100\n.param R2_555 50k\n.param C_555 1u
TEXT 1256 1136 Left 2 ;To force switching in the middle of the last ton time when the circuit is in astable mode
TEXT -744 784 Left 2 !.param R_delay 30K\n.param C_delay 10u
